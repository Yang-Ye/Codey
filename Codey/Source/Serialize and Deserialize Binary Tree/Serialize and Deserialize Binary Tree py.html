<!-- HTML generated by Yang Ye --><div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #888888"># Time:  O(n)</span>
<span style="color: #888888"># Space: O(h)</span>

<span style="color: #888888"># Serialization is the process of converting a data structure or</span>
<span style="color: #888888"># object into a sequence of bits so that it can be stored in a file</span>
<span style="color: #888888"># or memory buffer, or transmitted across a network connection link</span>
<span style="color: #888888"># to be reconstructed later in the same or another computer environment.</span>
<span style="color: #888888">#</span>
<span style="color: #888888"># Design an algorithm to serialize and deserialize a binary tree. </span>
<span style="color: #888888"># There is no restriction on how your serialization/deserialization</span>
<span style="color: #888888"># algorithm should work. You just need to ensure that a binary tree can </span>
<span style="color: #888888"># be serialized to a string and this string can be deserialized to the </span>
<span style="color: #888888"># original tree structure.</span>
<span style="color: #888888">#</span>
<span style="color: #888888"># For example, you may serialize the following tree</span>
<span style="color: #888888">#</span>
<span style="color: #888888">#     1</span>
<span style="color: #888888">#   / \</span>
<span style="color: #888888">#   2   3</span>
<span style="color: #888888">#      / \</span>
<span style="color: #888888">#     4   5</span>
<span style="color: #888888"># as &quot;[1,2,3,null,null,4,5]&quot;, just the same as how LeetCode OJ serializes</span>
<span style="color: #888888"># a binary tree. You do not necessarily need to follow this format, so </span>
<span style="color: #888888"># please be creative and come up with different approaches yourself.</span>
<span style="color: #888888"># Note: Do not use class member/global/static variables to store states. </span>
<span style="color: #888888"># Your serialize and deserialize algorithms should be stateless.</span>
<span style="color: #888888">#</span>

<span style="color: #888888"># Definition for a binary tree node.</span>
<span style="color: #888888"># class TreeNode(object):</span>
<span style="color: #888888">#     def __init__(self, x):</span>
<span style="color: #888888">#         self.val = x</span>
<span style="color: #888888">#         self.left = None</span>
<span style="color: #888888">#         self.right = None</span>
<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Codec</span>:

    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">serialize</span>(<span style="color: #007020">self</span>, root):
        <span style="color: #DD4422">&quot;&quot;&quot;Encodes a tree to a single string.</span>
<span style="color: #DD4422">        </span>
<span style="color: #DD4422">        :type root: TreeNode</span>
<span style="color: #DD4422">        :rtype: str</span>
<span style="color: #DD4422">        &quot;&quot;&quot;</span>
        <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">serializeHelper</span>(node):
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> node:
                vals<span style="color: #333333">.</span>append(<span style="background-color: #fff0f0">&#39;#&#39;</span>)
            <span style="color: #008800; font-weight: bold">else</span>:
                vals<span style="color: #333333">.</span>append(<span style="color: #007020">str</span>(node<span style="color: #333333">.</span>val))
                serializeHelper(node<span style="color: #333333">.</span>left)
                serializeHelper(node<span style="color: #333333">.</span>right)
        vals <span style="color: #333333">=</span> []
        serializeHelper(root)
        <span style="color: #008800; font-weight: bold">return</span> <span style="background-color: #fff0f0">&#39; &#39;</span><span style="color: #333333">.</span>join(vals)


    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">deserialize</span>(<span style="color: #007020">self</span>, data):
        <span style="color: #DD4422">&quot;&quot;&quot;Decodes your encoded data to tree.</span>
<span style="color: #DD4422">        </span>
<span style="color: #DD4422">        :type data: str</span>
<span style="color: #DD4422">        :rtype: TreeNode</span>
<span style="color: #DD4422">        &quot;&quot;&quot;</span>
        <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">deserializeHelper</span>():
            val <span style="color: #333333">=</span> <span style="color: #007020">next</span>(vals)
            <span style="color: #008800; font-weight: bold">if</span> val <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&#39;#&#39;</span>:
                <span style="color: #008800; font-weight: bold">return</span> <span style="color: #007020">None</span>
            <span style="color: #008800; font-weight: bold">else</span>:
                node <span style="color: #333333">=</span> TreeNode(<span style="color: #007020">int</span>(val))
                node<span style="color: #333333">.</span>left <span style="color: #333333">=</span> deserializeHelper()
                node<span style="color: #333333">.</span>right <span style="color: #333333">=</span> deserializeHelper()
                <span style="color: #008800; font-weight: bold">return</span> node
        <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">isplit</span>(source, sep):
            sepsize <span style="color: #333333">=</span> <span style="color: #007020">len</span>(sep)
            start <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>
            <span style="color: #008800; font-weight: bold">while</span> <span style="color: #007020">True</span>:
                idx <span style="color: #333333">=</span> source<span style="color: #333333">.</span>find(sep, start)
                <span style="color: #008800; font-weight: bold">if</span> idx <span style="color: #333333">==</span> <span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span>:
                    <span style="color: #008800; font-weight: bold">yield</span> source[start:]
                    <span style="color: #008800; font-weight: bold">return</span>
                <span style="color: #008800; font-weight: bold">yield</span> source[start:idx]
                start <span style="color: #333333">=</span> idx <span style="color: #333333">+</span> sepsize
        vals <span style="color: #333333">=</span> <span style="color: #007020">iter</span>(isplit(data, <span style="background-color: #fff0f0">&#39; &#39;</span>))
        <span style="color: #008800; font-weight: bold">return</span> deserializeHelper()

<span style="color: #888888"># Your Codec object will be instantiated and called as such:</span>
<span style="color: #888888"># codec = Codec()</span>
<span style="color: #888888"># codec.deserialize(codec.serialize(root))</span>
</pre></div>
