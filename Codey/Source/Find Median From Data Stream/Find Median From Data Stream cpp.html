<!-- HTML generated by Yang Ye --><div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #888888">// Time:  O(nlogn) for total n addNums, O(logn) per addNum, O(1) per findMedian.</span>
<span style="color: #888888">// Space: O(n), total space</span>

<span style="color: #888888">// Heap solution.</span>
<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">MedianFinder</span> {
<span style="color: #008800; font-weight: bold">public</span><span style="color: #333333">:</span>

    <span style="color: #888888">// Adds a number into the data structure.</span>
    <span style="color: #333399; font-weight: bold">void</span> addNum(<span style="color: #333399; font-weight: bold">int</span> num) {
        <span style="color: #888888">// Balance smaller half and larger half.</span>
        <span style="color: #008800; font-weight: bold">if</span> (max_heap_.empty() <span style="color: #333333">||</span> num <span style="color: #333333">&gt;</span> max_heap_.top()) {
            min_heap_.emplace(num);
            <span style="color: #008800; font-weight: bold">if</span> (min_heap_.size() <span style="color: #333333">&gt;</span> max_heap_.size() <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span>) {
                max_heap_.emplace(min_heap_.top());
                min_heap_.pop();
            }
        } <span style="color: #008800; font-weight: bold">else</span> {
            max_heap_.emplace(num);
            <span style="color: #008800; font-weight: bold">if</span> (max_heap_.size() <span style="color: #333333">&gt;</span> min_heap_.size()) {
                min_heap_.emplace(max_heap_.top());
                max_heap_.pop();
            }
        }
    }

    <span style="color: #888888">// Returns the median of current data stream</span>
    <span style="color: #333399; font-weight: bold">double</span> findMedian() {
        <span style="color: #008800; font-weight: bold">return</span> min_heap_.size() <span style="color: #333333">==</span> max_heap_.size() <span style="color: #333333">?</span>
                   (max_heap_.top() <span style="color: #333333">+</span> min_heap_.top()) <span style="color: #333333">/</span> <span style="color: #6600EE; font-weight: bold">2.0</span> <span style="color: #333333">:</span>
                   min_heap_.top();

    }

<span style="color: #008800; font-weight: bold">private</span><span style="color: #333333">:</span>
    <span style="color: #888888">// min_heap_ stores the larger half seen so far.</span>
    priority_queue<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span>, vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span>, greater<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&gt;</span> min_heap_;
    <span style="color: #888888">// max_heap_ stores the smaller half seen so far.</span>
    priority_queue<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span>, vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span>, less<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&gt;</span> max_heap_;
};

<span style="color: #888888">// BST solution.</span>
<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">MedianFinder2</span> {
<span style="color: #008800; font-weight: bold">public</span><span style="color: #333333">:</span>

    <span style="color: #888888">// Adds a number into the data structure.</span>
    <span style="color: #333399; font-weight: bold">void</span> addNum(<span style="color: #333399; font-weight: bold">int</span> num) {
        <span style="color: #888888">// Balance smaller half and larger half.</span>
        <span style="color: #008800; font-weight: bold">if</span> (max_bst_.empty() <span style="color: #333333">||</span> num <span style="color: #333333">&gt;</span> <span style="color: #333333">*</span>max_bst_.cbegin()) {
            min_bst_.emplace(num);
            <span style="color: #008800; font-weight: bold">if</span> (min_bst_.size() <span style="color: #333333">&gt;</span> max_bst_.size() <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span>) {
                max_bst_.emplace(<span style="color: #333333">*</span>min_bst_.cbegin());
                min_bst_.erase(min_bst_.cbegin());
            }
        } <span style="color: #008800; font-weight: bold">else</span> {
            max_bst_.emplace(num);
            <span style="color: #008800; font-weight: bold">if</span> (max_bst_.size() <span style="color: #333333">&gt;</span> min_bst_.size()) {
                min_bst_.emplace(<span style="color: #333333">*</span>max_bst_.cbegin());
                max_bst_.erase(max_bst_.cbegin());
            }
        }
    }

    <span style="color: #888888">// Returns the median of current data stream</span>
    <span style="color: #333399; font-weight: bold">double</span> findMedian() {
        <span style="color: #008800; font-weight: bold">return</span> min_bst_.size() <span style="color: #333333">==</span> max_bst_.size() <span style="color: #333333">?</span>
                   (<span style="color: #333333">*</span>max_bst_.cbegin() <span style="color: #333333">+</span> <span style="color: #333333">*</span>min_bst_.cbegin()) <span style="color: #333333">/</span> <span style="color: #6600EE; font-weight: bold">2.0</span> <span style="color: #333333">:</span>
                   <span style="color: #333333">*</span>min_bst_.cbegin();

    }

<span style="color: #008800; font-weight: bold">private</span><span style="color: #333333">:</span>
   <span style="color: #888888">// min_bst_ stores the larger half seen so far.</span>
    multiset<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span>, less<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&gt;</span> min_bst_;
    <span style="color: #888888">// max_bst_ stores the smaller half seen so far.</span>
    multiset<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span>, greater<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&gt;</span> max_bst_;
};

<span style="color: #888888">// Your MedianFinder object will be instantiated and called as such:</span>
<span style="color: #888888">// MedianFinder mf;</span>
<span style="color: #888888">// mf.addNum(1);</span>
<span style="color: #888888">// mf.findMedian();</span>
</pre></div>
