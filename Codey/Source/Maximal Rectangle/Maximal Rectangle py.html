<!-- HTML generated by Yang Ye --><div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #888888"># Time:  O(n^2)</span>
<span style="color: #888888"># Space: O(n)</span>

<span style="color: #888888"># Given a 2D binary matrix filled with 0&#39;s and 1&#39;s, </span>
<span style="color: #888888"># find the largest rectangle containing all ones and return its area.</span>

<span style="color: #888888"># Ascending stack solution.</span>
<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Solution</span>(<span style="color: #007020">object</span>):
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">maximalRectangle</span>(<span style="color: #007020">self</span>, matrix):
        <span style="color: #DD4422">&quot;&quot;&quot;</span>
<span style="color: #DD4422">        :type matrix: List[List[str]]</span>
<span style="color: #DD4422">        :rtype: int</span>
<span style="color: #DD4422">        &quot;&quot;&quot;</span>
        <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">largestRectangleArea</span>(heights):
            increasing, area, i <span style="color: #333333">=</span> [], <span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #0000DD; font-weight: bold">0</span>
            <span style="color: #008800; font-weight: bold">while</span> i <span style="color: #333333">&lt;=</span> <span style="color: #007020">len</span>(heights):
                <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> increasing <span style="color: #000000; font-weight: bold">or</span> (i <span style="color: #333333">&lt;</span> <span style="color: #007020">len</span>(heights) <span style="color: #000000; font-weight: bold">and</span> heights[i] <span style="color: #333333">&gt;</span> heights[increasing[<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span>]]):
                    increasing<span style="color: #333333">.</span>append(i)
                    i <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
                <span style="color: #008800; font-weight: bold">else</span>:
                    last <span style="color: #333333">=</span> increasing<span style="color: #333333">.</span>pop()
                    <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> increasing:
                        area <span style="color: #333333">=</span> <span style="color: #007020">max</span>(area, heights[last] <span style="color: #333333">*</span> i)
                    <span style="color: #008800; font-weight: bold">else</span>:
                        area <span style="color: #333333">=</span> <span style="color: #007020">max</span>(area, heights[last] <span style="color: #333333">*</span> (i <span style="color: #333333">-</span> increasing[<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span>] <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span> ))
            <span style="color: #008800; font-weight: bold">return</span> area

        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> matrix:
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #0000DD; font-weight: bold">0</span>

        result <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>
        heights <span style="color: #333333">=</span> [<span style="color: #0000DD; font-weight: bold">0</span>] <span style="color: #333333">*</span> <span style="color: #007020">len</span>(matrix[<span style="color: #0000DD; font-weight: bold">0</span>])
        <span style="color: #008800; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(<span style="color: #007020">len</span>(matrix)):
            <span style="color: #008800; font-weight: bold">for</span> j <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(<span style="color: #007020">len</span>(matrix[<span style="color: #0000DD; font-weight: bold">0</span>])):
                heights[j] <span style="color: #333333">=</span> heights[j] <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span> <span style="color: #008800; font-weight: bold">if</span> matrix[i][j] <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&#39;1&#39;</span> <span style="color: #008800; font-weight: bold">else</span> <span style="color: #0000DD; font-weight: bold">0</span>
            result <span style="color: #333333">=</span> <span style="color: #007020">max</span>(result, largestRectangleArea(heights))

        <span style="color: #008800; font-weight: bold">return</span> result


<span style="color: #888888"># Time:  O(n^2)</span>
<span style="color: #888888"># Space: O(n)</span>
<span style="color: #888888"># DP solution.</span>
<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Solution2</span>(<span style="color: #007020">object</span>):
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">maximalRectangle</span>(<span style="color: #007020">self</span>, matrix):
        <span style="color: #DD4422">&quot;&quot;&quot;</span>
<span style="color: #DD4422">        :type matrix: List[List[str]]</span>
<span style="color: #DD4422">        :rtype: int</span>
<span style="color: #DD4422">        &quot;&quot;&quot;</span>
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> matrix:
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #0000DD; font-weight: bold">0</span>
        
        result <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>
        m <span style="color: #333333">=</span> <span style="color: #007020">len</span>(matrix)
        n <span style="color: #333333">=</span> <span style="color: #007020">len</span>(matrix[<span style="color: #0000DD; font-weight: bold">0</span>])
        L <span style="color: #333333">=</span> [<span style="color: #0000DD; font-weight: bold">0</span> <span style="color: #008800; font-weight: bold">for</span> _ <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(n)]
        H <span style="color: #333333">=</span> [<span style="color: #0000DD; font-weight: bold">0</span> <span style="color: #008800; font-weight: bold">for</span> _ <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(n)]
        R <span style="color: #333333">=</span> [n <span style="color: #008800; font-weight: bold">for</span> _ <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(n)]

        <span style="color: #008800; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(m):
            left <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>
            <span style="color: #008800; font-weight: bold">for</span> j <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(n):
                <span style="color: #008800; font-weight: bold">if</span> matrix[i][j] <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&#39;1&#39;</span>:
                    L[j] <span style="color: #333333">=</span> <span style="color: #007020">max</span>(L[j], left)
                    H[j] <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
                <span style="color: #008800; font-weight: bold">else</span>:
                    L[j] <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>
                    H[j] <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>
                    R[j] <span style="color: #333333">=</span> n
                    left <span style="color: #333333">=</span> j <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span>
                    
            right <span style="color: #333333">=</span> n
            <span style="color: #008800; font-weight: bold">for</span> j <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">reversed</span>(<span style="color: #007020">xrange</span>(n)):
                <span style="color: #008800; font-weight: bold">if</span> matrix[i][j] <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&#39;1&#39;</span>:
                    R[j] <span style="color: #333333">=</span> <span style="color: #007020">min</span>(R[j], right)
                    result <span style="color: #333333">=</span> <span style="color: #007020">max</span>(result, H[j] <span style="color: #333333">*</span> (R[j] <span style="color: #333333">-</span> L[j]))
                <span style="color: #008800; font-weight: bold">else</span>:
                    right <span style="color: #333333">=</span> j
                    
        <span style="color: #008800; font-weight: bold">return</span> result

<span style="color: #008800; font-weight: bold">if</span> __name__ <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;__main__&quot;</span>:
    matrix <span style="color: #333333">=</span> [<span style="background-color: #fff0f0">&quot;01101&quot;</span>,
              <span style="background-color: #fff0f0">&quot;11010&quot;</span>,
              <span style="background-color: #fff0f0">&quot;01110&quot;</span>,
              <span style="background-color: #fff0f0">&quot;11110&quot;</span>,
              <span style="background-color: #fff0f0">&quot;11111&quot;</span>,
              <span style="background-color: #fff0f0">&quot;00000&quot;</span>]
    <span style="color: #008800; font-weight: bold">print</span> Solution()<span style="color: #333333">.</span>maximalRectangle(matrix)
</pre></div>
