<!-- HTML generated by Yang Ye --><div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #888888"># Time:  O(nlogn)</span>
<span style="color: #888888"># Space: O(n)</span>
<span style="color: #888888">#</span>
<span style="color: #888888"># A city&#39;s skyline is the outer contour of the silhouette formed </span>
<span style="color: #888888"># by all the buildings in that city when viewed from a distance. </span>
<span style="color: #888888"># Now suppose you are given the locations and height of all the </span>
<span style="color: #888888"># buildings as shown on a cityscape photo (Figure A), write a</span>
<span style="color: #888888"># program to output the skyline formed by these buildings </span>
<span style="color: #888888"># collectively (Figure B).</span>
<span style="color: #888888"># </span>
<span style="color: #888888"># The geometric information of each building is represented by a </span>
<span style="color: #888888"># triplet of integers [Li, Ri, Hi], where Li and Ri are the x </span>
<span style="color: #888888"># coordinates of the left and right edge of the ith building, </span>
<span style="color: #888888"># respectively, and Hi is its height. It is guaranteed that 0 &lt;= Li, </span>
<span style="color: #888888"># Ri &lt;= INT_MAX, 0 &lt; Hi &lt;= INT_MAX, and Ri - Li &gt; 0. You may assume </span>
<span style="color: #888888"># all buildings are perfect rectangles grounded on an absolutely </span>
<span style="color: #888888"># flat surface at height 0.</span>
<span style="color: #888888"># </span>
<span style="color: #888888"># Notes:</span>
<span style="color: #888888"># </span>
<span style="color: #888888"># The number of buildings in any input list is guaranteed to be </span>
<span style="color: #888888"># in the range [0, 10000].</span>
<span style="color: #888888"># The input list is already sorted in ascending order by the </span>
<span style="color: #888888"># left x position Li.</span>
<span style="color: #888888"># The output list must be sorted by the x position.</span>
<span style="color: #888888"># There must be no consecutive horizontal lines of equal height </span>
<span style="color: #888888"># in the output skyline. </span>
<span style="color: #888888"># For instance, [...[2 3], [4 5], [7 5], [11 5], [12 7]...] is </span>
<span style="color: #888888"># not acceptable; </span>
<span style="color: #888888"># the three lines of height 5 should be merged into one </span>
<span style="color: #888888"># in the final output as such: [...[2 3], [4 5], [12 7], ...]</span>
<span style="color: #888888">#</span>

<span style="color: #888888"># Divide and conquer solution.</span>
start, end, height <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #0000DD; font-weight: bold">1</span>, <span style="color: #0000DD; font-weight: bold">2</span>
<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Solution</span>:
    <span style="color: #888888"># @param {integer[][]} buildings</span>
    <span style="color: #888888"># @return {integer[][]}</span>
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">getSkyline</span>(<span style="color: #007020">self</span>, buildings):
        intervals <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>ComputeSkylineInInterval(buildings, <span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #007020">len</span>(buildings))
        
        res <span style="color: #333333">=</span> []
        last_end <span style="color: #333333">=</span> <span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span>
        <span style="color: #008800; font-weight: bold">for</span> interval <span style="color: #000000; font-weight: bold">in</span> intervals:
            <span style="color: #008800; font-weight: bold">if</span> last_end <span style="color: #333333">!=</span> <span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span> <span style="color: #000000; font-weight: bold">and</span> last_end <span style="color: #333333">&lt;</span> interval[start]:
                res<span style="color: #333333">.</span>append([last_end, <span style="color: #0000DD; font-weight: bold">0</span>])
            res<span style="color: #333333">.</span>append([interval[start], interval[height]])
            last_end <span style="color: #333333">=</span> interval[end]
        <span style="color: #008800; font-weight: bold">if</span> last_end <span style="color: #333333">!=</span> <span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span>:
            res<span style="color: #333333">.</span>append([last_end, <span style="color: #0000DD; font-weight: bold">0</span>])
            
        <span style="color: #008800; font-weight: bold">return</span> res
    
    <span style="color: #888888"># Divide and Conquer.</span>
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">ComputeSkylineInInterval</span>(<span style="color: #007020">self</span>, buildings, left_endpoint, right_endpoint):
        <span style="color: #008800; font-weight: bold">if</span> right_endpoint <span style="color: #333333">-</span> left_endpoint <span style="color: #333333">&lt;=</span> <span style="color: #0000DD; font-weight: bold">1</span>:
            <span style="color: #008800; font-weight: bold">return</span> buildings[left_endpoint:right_endpoint]
        mid <span style="color: #333333">=</span> left_endpoint <span style="color: #333333">+</span> ((right_endpoint <span style="color: #333333">-</span> left_endpoint) <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span>)
        left_skyline <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>ComputeSkylineInInterval(buildings, left_endpoint, mid)
        right_skyline <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>ComputeSkylineInInterval(buildings, mid, right_endpoint)
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>MergeSkylines(left_skyline, right_skyline)
    
    <span style="color: #888888"># Merge Sort.</span>
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">MergeSkylines</span>(<span style="color: #007020">self</span>, left_skyline, right_skyline):
        i, j <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #0000DD; font-weight: bold">0</span>
        merged <span style="color: #333333">=</span> []
        
        <span style="color: #008800; font-weight: bold">while</span> i <span style="color: #333333">&lt;</span> <span style="color: #007020">len</span>(left_skyline) <span style="color: #000000; font-weight: bold">and</span> j <span style="color: #333333">&lt;</span> <span style="color: #007020">len</span>(right_skyline):
            <span style="color: #008800; font-weight: bold">if</span> left_skyline[i][end] <span style="color: #333333">&lt;</span> right_skyline[j][start]:
                merged<span style="color: #333333">.</span>append(left_skyline[i])
                i <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
            <span style="color: #008800; font-weight: bold">elif</span> right_skyline[j][end] <span style="color: #333333">&lt;</span> left_skyline[i][start]:
                merged<span style="color: #333333">.</span>append(right_skyline[j])
                j <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
            <span style="color: #008800; font-weight: bold">elif</span> left_skyline[i][start] <span style="color: #333333">&lt;=</span> right_skyline[j][start]:
                i, j <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>MergeIntersectSkylines(merged, left_skyline[i], i,\
                                                   right_skyline[j], j)
            <span style="color: #008800; font-weight: bold">else</span>: <span style="color: #888888"># left_skyline[i][start] &gt; right_skyline[j][start].</span>
                j, i <span style="color: #333333">=</span> <span style="color: #007020">self</span><span style="color: #333333">.</span>MergeIntersectSkylines(merged, right_skyline[j], j, \
                                                   left_skyline[i], i)
        
        <span style="color: #888888"># Insert the remaining skylines.</span>
        merged <span style="color: #333333">+=</span> left_skyline[i:]
        merged <span style="color: #333333">+=</span> right_skyline[j:]
        <span style="color: #008800; font-weight: bold">return</span> merged
    
    <span style="color: #888888"># a[start] &lt;= b[start]</span>
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">MergeIntersectSkylines</span>(<span style="color: #007020">self</span>, merged, a, a_idx, b, b_idx):
        <span style="color: #008800; font-weight: bold">if</span> a[end] <span style="color: #333333">&lt;=</span> b[end]:
            <span style="color: #008800; font-weight: bold">if</span> a[height] <span style="color: #333333">&gt;</span> b[height]:   <span style="color: #888888"># |aaa|</span>
                <span style="color: #008800; font-weight: bold">if</span> b[end] <span style="color: #333333">!=</span> a[end]:    <span style="color: #888888"># |abb|b</span>
                    b[start] <span style="color: #333333">=</span> a[end]
                    merged<span style="color: #333333">.</span>append(a)
                    a_idx <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
                <span style="color: #008800; font-weight: bold">else</span>:             <span style="color: #888888"># aaa</span>
                    b_idx <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>    <span style="color: #888888"># abb</span>
            <span style="color: #008800; font-weight: bold">elif</span> a[height] <span style="color: #333333">==</span> b[height]:  <span style="color: #888888"># abb</span>
                b[start] <span style="color: #333333">=</span> a[start]       <span style="color: #888888"># abb</span>
                a_idx <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
            <span style="color: #008800; font-weight: bold">else</span>:  <span style="color: #888888"># a[height] &lt; b[height].</span>
                <span style="color: #008800; font-weight: bold">if</span> a[start] <span style="color: #333333">!=</span> b[start]:                            <span style="color: #888888">#    bb</span>
                    merged<span style="color: #333333">.</span>append([a[start], b[start], a[height]])  <span style="color: #888888"># |a|bb</span>
                a_idx <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
        <span style="color: #008800; font-weight: bold">else</span>:  <span style="color: #888888"># a[end] &gt; b[end].</span>
            <span style="color: #008800; font-weight: bold">if</span> a[height] <span style="color: #333333">&gt;=</span> b[height]:  <span style="color: #888888"># aaaa</span>
                b_idx <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>              <span style="color: #888888"># abba</span>
            <span style="color: #008800; font-weight: bold">else</span>:
                <span style="color: #888888">#    |bb|</span>
                <span style="color: #888888"># |a||bb|a</span>
                <span style="color: #008800; font-weight: bold">if</span> a[start] <span style="color: #333333">!=</span> b[start]:
                    merged<span style="color: #333333">.</span>append([a[start], b[start], a[height]])
                a[start] <span style="color: #333333">=</span> b[end]
                merged<span style="color: #333333">.</span>append(b)
                b_idx <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
        <span style="color: #008800; font-weight: bold">return</span> a_idx, b_idx
</pre></div>
