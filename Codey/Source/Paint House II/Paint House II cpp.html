<!-- HTML generated by Yang Ye --><div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #888888">// Time:  O(n * k)</span>
<span style="color: #888888">// Space: O(k)</span>

<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Solution</span> {
<span style="color: #008800; font-weight: bold">public</span><span style="color: #333333">:</span>
    <span style="color: #333399; font-weight: bold">int</span> minCostII(vector<span style="color: #333333">&lt;</span>vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&gt;&amp;</span> costs) {
        <span style="color: #008800; font-weight: bold">if</span> (costs.empty()) {
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #0000DD; font-weight: bold">0</span>;
        }
        
        vector<span style="color: #333333">&lt;</span>vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&gt;</span> min_cost(<span style="color: #0000DD; font-weight: bold">2</span>, costs[<span style="color: #0000DD; font-weight: bold">0</span>]);

        <span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> n <span style="color: #333333">=</span> costs.size();
        <span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> k <span style="color: #333333">=</span> costs[<span style="color: #0000DD; font-weight: bold">0</span>].size();
        <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1</span>; i <span style="color: #333333">&lt;</span> n; <span style="color: #333333">++</span>i) {
            <span style="color: #333399; font-weight: bold">int</span> smallest <span style="color: #333333">=</span> numeric_limits<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;::</span>max(), second_smallest <span style="color: #333333">=</span> numeric_limits<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;::</span>max();
            <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #333399; font-weight: bold">int</span> j <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>; j <span style="color: #333333">&lt;</span> k; <span style="color: #333333">++</span>j) {
                <span style="color: #008800; font-weight: bold">if</span> (min_cost[(i <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #333333">%</span> <span style="color: #0000DD; font-weight: bold">2</span>][j] <span style="color: #333333">&lt;</span> smallest) {
                    second_smallest <span style="color: #333333">=</span> smallest;
                    smallest <span style="color: #333333">=</span> min_cost[(i <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #333333">%</span> <span style="color: #0000DD; font-weight: bold">2</span>][j];
                } <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">if</span> (min_cost[(i <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #333333">%</span> <span style="color: #0000DD; font-weight: bold">2</span>][j] <span style="color: #333333">&lt;</span> second_smallest) {
                    second_smallest <span style="color: #333333">=</span> min_cost[(i <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #333333">%</span> <span style="color: #0000DD; font-weight: bold">2</span>][j];
                }
            }
            <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #333399; font-weight: bold">int</span> j <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>; j <span style="color: #333333">&lt;</span> k; <span style="color: #333333">++</span>j) {
                <span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> min_j <span style="color: #333333">=</span> (min_cost[(i <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #333333">%</span> <span style="color: #0000DD; font-weight: bold">2</span>][j] <span style="color: #333333">!=</span> smallest) <span style="color: #333333">?</span> <span style="color: #997700; font-weight: bold">smallest</span> : second_smallest;
                min_cost[i <span style="color: #333333">%</span> <span style="color: #0000DD; font-weight: bold">2</span>][j] <span style="color: #333333">=</span> costs[i][j] <span style="color: #333333">+</span> min_j;
            }
        }

        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #333333">*</span>min_element(min_cost[(n <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #333333">%</span> <span style="color: #0000DD; font-weight: bold">2</span>].cbegin(), min_cost[(n <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #333333">%</span> <span style="color: #0000DD; font-weight: bold">2</span>].cend());
    }
};

<span style="color: #888888">// Time:  O(n * k)</span>
<span style="color: #888888">// Space: O(k)</span>
<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Solution2</span>{
<span style="color: #008800; font-weight: bold">public</span><span style="color: #333333">:</span>
    <span style="color: #333399; font-weight: bold">int</span> minCostII(vector<span style="color: #333333">&lt;</span>vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&gt;&amp;</span> costs) {
        <span style="color: #008800; font-weight: bold">if</span> (costs.empty()) {
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #0000DD; font-weight: bold">0</span>;
        }
        <span style="color: #008800; font-weight: bold">auto</span> combine <span style="color: #333333">=</span> [](<span style="color: #008800; font-weight: bold">const</span> vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&amp;</span> tmp, <span style="color: #008800; font-weight: bold">const</span> vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&amp;</span> house) {
                            <span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> smallest <span style="color: #333333">=</span> <span style="color: #333333">*</span>min_element(tmp.cbegin(), tmp.cend());
                            <span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> distance(tmp.begin(), find(tmp.cbegin(), tmp.cend(), smallest));
                            vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> tmp2(tmp);
                            tmp2.erase(tmp2.begin() <span style="color: #333333">+</span> i);
                            <span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> second_smallest <span style="color: #333333">=</span> <span style="color: #333333">*</span>min_element(tmp2.cbegin(), tmp2.cend());
                            vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> min_cost(tmp.size(), smallest);
                            min_cost[i] <span style="color: #333333">=</span> second_smallest;
                            transform(min_cost.cbegin(), min_cost.cend(), house.cbegin(),
                                      min_cost.begin(), std<span style="color: #333333">::</span>plus<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span>());
                            <span style="color: #008800; font-weight: bold">return</span> min_cost;
                        };
        vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> min_cost <span style="color: #333333">=</span> accumulate(costs.cbegin(), costs.cend(), vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span>(costs[<span style="color: #0000DD; font-weight: bold">0</span>].size(), <span style="color: #0000DD; font-weight: bold">0</span>), combine);
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #333333">*</span><span style="color: #0066BB; font-weight: bold">min_element</span>(min_cost.cbegin(), min_cost.cend());
    }
};
</pre></div>
