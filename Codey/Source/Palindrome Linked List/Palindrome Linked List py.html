<!-- HTML generated by Yang Ye --><div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #888888"># Time:  O(n)</span>
<span style="color: #888888"># Space: O(1)</span>
<span style="color: #888888">#</span>
<span style="color: #888888"># Given a singly linked list, determine if it is a palindrome.</span>
<span style="color: #888888">#</span>
<span style="color: #888888"># Follow up:</span>
<span style="color: #888888"># Could you do it in O(n) time and O(1) space?</span>
<span style="color: #888888">#</span>
<span style="color: #888888"># Definition for singly-linked list.</span>
<span style="color: #888888"># class ListNode:</span>
<span style="color: #888888">#     def __init__(self, x):</span>
<span style="color: #888888">#         self.val = x</span>
<span style="color: #888888">#         self.next = None</span>
<span style="color: #888888">#</span>

<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Solution</span>:
    <span style="color: #888888"># @param {ListNode} head</span>
    <span style="color: #888888"># @return {boolean}</span>
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">isPalindrome</span>(<span style="color: #007020">self</span>, head):
        reverse, fast <span style="color: #333333">=</span> <span style="color: #007020">None</span>, head
        <span style="color: #888888"># Reverse the first half part of the list.</span>
        <span style="color: #008800; font-weight: bold">while</span> fast <span style="color: #000000; font-weight: bold">and</span> fast<span style="color: #333333">.</span>next:
            fast <span style="color: #333333">=</span> fast<span style="color: #333333">.</span>next<span style="color: #333333">.</span>next
            head<span style="color: #333333">.</span>next, reverse, head <span style="color: #333333">=</span> reverse, head, head<span style="color: #333333">.</span>next

        <span style="color: #888888"># If the number of the nodes is odd,</span>
        <span style="color: #888888"># set the head of the tail list to the next of the median node.</span>
        tail <span style="color: #333333">=</span> head<span style="color: #333333">.</span>next <span style="color: #008800; font-weight: bold">if</span> fast <span style="color: #008800; font-weight: bold">else</span> head

        <span style="color: #888888"># Compare the reversed first half list with the second half list.</span>
        <span style="color: #888888"># And restore the reversed first half list.</span>
        is_palindrome <span style="color: #333333">=</span> <span style="color: #007020">True</span>
        <span style="color: #008800; font-weight: bold">while</span> reverse:
            is_palindrome <span style="color: #333333">=</span> is_palindrome <span style="color: #000000; font-weight: bold">and</span> reverse<span style="color: #333333">.</span>val <span style="color: #333333">==</span> tail<span style="color: #333333">.</span>val
            reverse<span style="color: #333333">.</span>next, head, reverse <span style="color: #333333">=</span> head, reverse, reverse<span style="color: #333333">.</span>next
            tail <span style="color: #333333">=</span> tail<span style="color: #333333">.</span>next

        <span style="color: #008800; font-weight: bold">return</span> is_palindrome
</pre></div>
