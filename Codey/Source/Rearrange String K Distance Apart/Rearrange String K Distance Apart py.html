<!-- HTML generated by Yang Ye --><div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #888888"># Time:  O(n)</span>
<span style="color: #888888"># Space: O(n)</span>

<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Solution</span>(<span style="color: #007020">object</span>):
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">rearrangeString</span>(<span style="color: #007020">self</span>, <span style="color: #007020">str</span>, k):
        <span style="color: #DD4422">&quot;&quot;&quot;</span>
<span style="color: #DD4422">        :type str: str</span>
<span style="color: #DD4422">        :type k: int</span>
<span style="color: #DD4422">        :rtype: str</span>
<span style="color: #DD4422">        &quot;&quot;&quot;</span>
        cnts <span style="color: #333333">=</span> [<span style="color: #0000DD; font-weight: bold">0</span>] <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">26</span>;
        <span style="color: #008800; font-weight: bold">for</span> c <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">str</span>:
            cnts[<span style="color: #007020">ord</span>(c) <span style="color: #333333">-</span> <span style="color: #007020">ord</span>(<span style="background-color: #fff0f0">&#39;a&#39;</span>)] <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>

        sorted_cnts <span style="color: #333333">=</span> []
        <span style="color: #008800; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(<span style="color: #0000DD; font-weight: bold">26</span>):
            sorted_cnts<span style="color: #333333">.</span>append((cnts[i], <span style="color: #007020">chr</span>(i <span style="color: #333333">+</span> <span style="color: #007020">ord</span>(<span style="background-color: #fff0f0">&#39;a&#39;</span>))))
        sorted_cnts<span style="color: #333333">.</span>sort(reverse<span style="color: #333333">=</span><span style="color: #007020">True</span>)

        max_cnt <span style="color: #333333">=</span> sorted_cnts[<span style="color: #0000DD; font-weight: bold">0</span>][<span style="color: #0000DD; font-weight: bold">0</span>]
        blocks <span style="color: #333333">=</span> [[] <span style="color: #008800; font-weight: bold">for</span> _ <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(max_cnt)]
        i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>
        <span style="color: #008800; font-weight: bold">for</span> cnt <span style="color: #000000; font-weight: bold">in</span> sorted_cnts:
            <span style="color: #008800; font-weight: bold">for</span> _ <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(cnt[<span style="color: #0000DD; font-weight: bold">0</span>]):
                blocks[i]<span style="color: #333333">.</span>append(cnt[<span style="color: #0000DD; font-weight: bold">1</span>])
                i <span style="color: #333333">=</span> (i <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #333333">%</span> <span style="color: #007020">max</span>(cnt[<span style="color: #0000DD; font-weight: bold">0</span>], max_cnt <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>)

        <span style="color: #008800; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(max_cnt<span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span>):
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #007020">len</span>(blocks[i]) <span style="color: #333333">&lt;</span> k:
                <span style="color: #008800; font-weight: bold">return</span> <span style="background-color: #fff0f0">&quot;&quot;</span>

        <span style="color: #008800; font-weight: bold">return</span> <span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">.</span>join(<span style="color: #007020">map</span>(<span style="color: #008800; font-weight: bold">lambda</span> x : <span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">.</span>join(x), blocks))


<span style="color: #888888"># Time:  O(nlogc), c is the count of unique characters.</span>
<span style="color: #888888"># Space: O(c)</span>
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">collections</span> <span style="color: #008800; font-weight: bold">import</span> defaultdict
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">heapq</span> <span style="color: #008800; font-weight: bold">import</span> heappush, heappop
<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Solution2</span>(<span style="color: #007020">object</span>):
    <span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">rearrangeString</span>(<span style="color: #007020">self</span>, <span style="color: #007020">str</span>, k):
        <span style="color: #DD4422">&quot;&quot;&quot;</span>
<span style="color: #DD4422">        :type str: str</span>
<span style="color: #DD4422">        :type k: int</span>
<span style="color: #DD4422">        :rtype: str</span>
<span style="color: #DD4422">        &quot;&quot;&quot;</span>
        <span style="color: #008800; font-weight: bold">if</span> k <span style="color: #333333">==</span> <span style="color: #0000DD; font-weight: bold">0</span>:
            <span style="color: #008800; font-weight: bold">return</span> <span style="color: #007020">str</span>

        cnts <span style="color: #333333">=</span> defaultdict(<span style="color: #007020">int</span>)
        <span style="color: #008800; font-weight: bold">for</span> c <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">str</span>:
            cnts[c] <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>

        heap <span style="color: #333333">=</span> []
        <span style="color: #008800; font-weight: bold">for</span> c, cnt <span style="color: #000000; font-weight: bold">in</span> cnts<span style="color: #333333">.</span>iteritems():
            heappush(heap, [<span style="color: #333333">-</span>cnt, c])

        result <span style="color: #333333">=</span> []
        <span style="color: #008800; font-weight: bold">while</span> heap:
            used_cnt_chars <span style="color: #333333">=</span> []
            <span style="color: #008800; font-weight: bold">for</span> _ <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">xrange</span>(<span style="color: #007020">min</span>(k, <span style="color: #007020">len</span>(<span style="color: #007020">str</span>) <span style="color: #333333">-</span> <span style="color: #007020">len</span>(result))):
                <span style="color: #008800; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> heap:
                    <span style="color: #008800; font-weight: bold">return</span> <span style="background-color: #fff0f0">&quot;&quot;</span>
                cnt_char <span style="color: #333333">=</span> heappop(heap)
                result<span style="color: #333333">.</span>append(cnt_char[<span style="color: #0000DD; font-weight: bold">1</span>])
                cnt_char[<span style="color: #0000DD; font-weight: bold">0</span>] <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span>
                <span style="color: #008800; font-weight: bold">if</span> cnt_char[<span style="color: #0000DD; font-weight: bold">0</span>] <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">0</span>:
                    used_cnt_chars<span style="color: #333333">.</span>append(cnt_char)
            <span style="color: #008800; font-weight: bold">for</span> cnt_char <span style="color: #000000; font-weight: bold">in</span> used_cnt_chars:
                heappush(heap, cnt_char)

        <span style="color: #008800; font-weight: bold">return</span> <span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">.</span>join(result)
</pre></div>
