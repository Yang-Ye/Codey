<!-- HTML generated by Yang Ye --><div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #888888">// Time:  O(nlog*n) ~= O(n), n is the length of the positions</span>
<span style="color: #888888">// Space: O(n)</span>

<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Solution</span> {
<span style="color: #008800; font-weight: bold">public</span><span style="color: #333333">:</span>
    <span style="color: #333399; font-weight: bold">int</span> countComponents(<span style="color: #333399; font-weight: bold">int</span> n, vector<span style="color: #333333">&lt;</span>pair<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span>, <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&gt;&amp;</span> edges) {
        UnionFind union_find(n);
        <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #008800; font-weight: bold">const</span> <span style="color: #008800; font-weight: bold">auto</span><span style="color: #333333">&amp;</span> <span style="color: #997700; font-weight: bold">e</span> : edges) {
            union_find.union_set(e.first, e.second);
        }
        <span style="color: #008800; font-weight: bold">return</span> union_find.length();
    }

<span style="color: #008800; font-weight: bold">private</span><span style="color: #333333">:</span>
    <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">UnionFind</span> {
        <span style="color: #008800; font-weight: bold">public</span><span style="color: #333333">:</span>
            UnionFind(<span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> n) <span style="color: #333333">:</span> set_(n), count_(n) {
                iota(set_.begin(), set_.end(), <span style="color: #0000DD; font-weight: bold">0</span>);
            }

            <span style="color: #333399; font-weight: bold">int</span> find_set(<span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> x) {
               <span style="color: #008800; font-weight: bold">if</span> (set_[x] <span style="color: #333333">!=</span> x) {
                   set_[x] <span style="color: #333333">=</span> find_set(set_[x]);  <span style="color: #888888">// Path compression.</span>
               }
               <span style="color: #008800; font-weight: bold">return</span> set_[x];
            }

            <span style="color: #333399; font-weight: bold">void</span> union_set(<span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> x, <span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> y) {
                <span style="color: #333399; font-weight: bold">int</span> x_root <span style="color: #333333">=</span> find_set(x), y_root <span style="color: #333333">=</span> find_set(y);
                <span style="color: #008800; font-weight: bold">if</span> (x_root <span style="color: #333333">!=</span> y_root) {
                    set_[min(x_root, y_root)] <span style="color: #333333">=</span> max(x_root, y_root);
                    <span style="color: #333333">--</span>count_;
                }
            }

            <span style="color: #333399; font-weight: bold">int</span> length() <span style="color: #008800; font-weight: bold">const</span> {
                <span style="color: #008800; font-weight: bold">return</span> count_;
            }

        <span style="color: #008800; font-weight: bold">private</span><span style="color: #333333">:</span>
            vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> set_;
            <span style="color: #333399; font-weight: bold">int</span> count_;
    };
};
</pre></div>
