<!-- HTML generated by Yang Ye --><div style="background: #ffffff; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span></span><span style="color: #888888">// Time:  O(k * (m + n + k)) ~ O(k * (m + n + k^2))</span>
<span style="color: #888888">// Space: O(m + n + k^2)</span>

<span style="color: #888888">// DP + Greedy solution.</span>
<span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Solution</span> {
<span style="color: #008800; font-weight: bold">public</span><span style="color: #333333">:</span>
    vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> maxNumber(vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&amp;</span> nums1, vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&amp;</span> nums2, <span style="color: #333399; font-weight: bold">int</span> k) {
        <span style="color: #008800; font-weight: bold">const</span> <span style="color: #333399; font-weight: bold">int</span> m <span style="color: #333333">=</span> nums1.size(), n <span style="color: #333333">=</span> nums2.size();
        vector<span style="color: #333333">&lt;</span>vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&gt;</span> max_numbers1(k <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span>), max_numbers2(k <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span>);
        maxNumberDP(nums1, max(<span style="color: #0000DD; font-weight: bold">0</span>, k <span style="color: #333333">-</span> n), min(k, m), <span style="color: #333333">&amp;</span>max_numbers1);  <span style="color: #888888">// O(k * m) time, O(m + k^2) space.</span>
        maxNumberDP(nums2, max(<span style="color: #0000DD; font-weight: bold">0</span>, k <span style="color: #333333">-</span> m), min(k, n), <span style="color: #333333">&amp;</span>max_numbers2);  <span style="color: #888888">// O(k * n) time, O(n + k^2) space.</span>

        vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> res(k);
        <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> max(<span style="color: #0000DD; font-weight: bold">0</span>, k <span style="color: #333333">-</span> n); i <span style="color: #333333">&lt;=</span> min(k, m); <span style="color: #333333">++</span>i) {  <span style="color: #888888">// k * O(k) ~ k * O(k^2) time</span>
            vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> tmp(k);
            merge(max_numbers1[i], max_numbers2[k <span style="color: #333333">-</span> i], <span style="color: #333333">&amp;</span>tmp);
            <span style="color: #008800; font-weight: bold">if</span> (tmp <span style="color: #333333">&gt;</span> res) {
                res <span style="color: #333333">=</span> move(tmp);
            }
        }
        <span style="color: #008800; font-weight: bold">return</span> res;
    }

<span style="color: #008800; font-weight: bold">private</span><span style="color: #333333">:</span>
    <span style="color: #333399; font-weight: bold">void</span> maxNumberDP(vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> nums, <span style="color: #333399; font-weight: bold">int</span> start, <span style="color: #333399; font-weight: bold">int</span> end, vector<span style="color: #333333">&lt;</span>vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&gt;</span> <span style="color: #333333">*</span>max_numbers) {
        (<span style="color: #333333">*</span>max_numbers)[end] <span style="color: #333333">=</span> maxNumber(nums, end);
        <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> end <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>; i <span style="color: #333333">&gt;=</span> start; <span style="color: #333333">--</span>i) {
            (<span style="color: #333333">*</span>max_numbers)[i] <span style="color: #333333">=</span> deleteNumber((<span style="color: #333333">*</span>max_numbers)[i <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span>]);
        }
    }

    <span style="color: #888888">// Time:  O(n)</span>
    <span style="color: #888888">// Space: O(n)</span>
    vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> maxNumber(<span style="color: #008800; font-weight: bold">const</span> vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&amp;</span> nums, <span style="color: #333399; font-weight: bold">int</span> k) {
        vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> res;
        <span style="color: #333399; font-weight: bold">int</span> drop <span style="color: #333333">=</span> nums.size() <span style="color: #333333">-</span> k;
        <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #008800; font-weight: bold">const</span> <span style="color: #008800; font-weight: bold">auto</span><span style="color: #333333">&amp;</span> <span style="color: #997700; font-weight: bold">num</span> : nums) {
            <span style="color: #008800; font-weight: bold">while</span> (drop <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">0</span> <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span>res.empty() <span style="color: #333333">&amp;&amp;</span> res.back() <span style="color: #333333">&lt;</span> num) {
                res.pop_back();
                <span style="color: #333333">--</span>drop;
            }
            res.emplace_back(num);
        }
        res.resize(k);
        <span style="color: #008800; font-weight: bold">return</span> res;
    }

    <span style="color: #888888">// Time:  O(n)</span>
    <span style="color: #888888">// Space: O(n)</span>
    vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> deleteNumber(<span style="color: #008800; font-weight: bold">const</span> vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&amp;</span> nums) {
        vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> res(nums);
        <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> res.size(); <span style="color: #333333">++</span>i) {
            <span style="color: #008800; font-weight: bold">if</span> (i <span style="color: #333333">==</span> res.size() <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span> <span style="color: #333333">||</span> res[i] <span style="color: #333333">&lt;</span> res[i <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span>]) {
                res.erase(res.begin() <span style="color: #333333">+</span> i);
                <span style="color: #008800; font-weight: bold">break</span>;
            }
        }
        <span style="color: #008800; font-weight: bold">return</span> res;
    }

    <span style="color: #888888">// Time:  O(k) ~ O(k^2)</span>
    <span style="color: #888888">// Space: O(1)</span>
    <span style="color: #333399; font-weight: bold">void</span> merge(<span style="color: #008800; font-weight: bold">const</span> vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&amp;</span> vec1, <span style="color: #008800; font-weight: bold">const</span> vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;&amp;</span> vec2, vector<span style="color: #333333">&lt;</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">&gt;</span> <span style="color: #333333">*</span>res) {
        <span style="color: #008800; font-weight: bold">auto</span> first1 <span style="color: #333333">=</span> vec1.begin(), last1 <span style="color: #333333">=</span> vec1.end(),
             first2 <span style="color: #333333">=</span> vec2.begin(), last2 <span style="color: #333333">=</span> vec2.end();
        <span style="color: #008800; font-weight: bold">auto</span> result <span style="color: #333333">=</span> res<span style="color: #333333">-&gt;</span>begin();
        <span style="color: #008800; font-weight: bold">while</span> (first1 <span style="color: #333333">!=</span> last1 <span style="color: #333333">||</span> first2 <span style="color: #333333">!=</span> last2) {
            <span style="color: #008800; font-weight: bold">if</span> (greater(first1, last1, first2, last2)) {
                <span style="color: #333333">*</span>result<span style="color: #333333">++</span> <span style="color: #333333">=</span> <span style="color: #333333">*</span>first1<span style="color: #333333">++</span>;
            } <span style="color: #008800; font-weight: bold">else</span> {
                <span style="color: #333333">*</span>result<span style="color: #333333">++</span> <span style="color: #333333">=</span> <span style="color: #333333">*</span>first2<span style="color: #333333">++</span>;
            }
        }
    }

    <span style="color: #008800; font-weight: bold">template</span><span style="color: #333333">&lt;</span><span style="color: #008800; font-weight: bold">typename</span> IT<span style="color: #333333">&gt;</span>
    <span style="color: #333399; font-weight: bold">bool</span> greater(IT first1, IT last1, IT first2, IT last2) {
        <span style="color: #008800; font-weight: bold">while</span> (first1 <span style="color: #333333">!=</span> last1 <span style="color: #333333">&amp;&amp;</span> first2 <span style="color: #333333">!=</span> last2 <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">*</span>first1 <span style="color: #333333">==</span> <span style="color: #333333">*</span>first2) {
            <span style="color: #333333">++</span>first1;
            <span style="color: #333333">++</span>first2;
        }
        <span style="color: #008800; font-weight: bold">return</span> (first2 <span style="color: #333333">==</span> last2) <span style="color: #333333">||</span> (first1 <span style="color: #333333">!=</span> last1 <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">*</span>first1 <span style="color: #333333">&gt;</span> <span style="color: #333333">*</span>first2);
    }
};
</pre></div>
